<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>لعبة Codenames مودرن وفخم</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #121212;
    color: #eee;
    margin: 0; padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
  }
  header {
    background: #1f1f1f;
    padding: 1rem;
    width: 100%;
    text-align: center;
    font-size: 1.8rem;
    font-weight: bold;
    letter-spacing: 2px;
    box-shadow: 0 3px 8px #000;
  }
  main {
    flex-grow: 1;
    max-width: 900px;
    width: 100%;
    padding: 1rem;
  }
  .room-section {
    background: #222;
    border-radius: 10px;
    padding: 1rem 1.5rem;
    margin-bottom: 2rem;
    box-shadow: 0 0 10px #0f0;
  }
  .room-section label {
    display: block;
    margin-bottom: 0.3rem;
    font-weight: 600;
  }
  .room-section input[type="text"] {
    width: 100%;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    border: none;
    font-size: 1rem;
  }
  .room-section button {
    margin-top: 0.7rem;
    padding: 0.6rem 1.4rem;
    border: none;
    border-radius: 6px;
    background: #0b0;
    color: #fff;
    font-weight: 700;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  .room-section button:hover {
    background: #0f0;
  }

  .board {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 10px;
  }
  .card {
    background: #333;
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
    font-weight: 600;
    font-size: 1.2rem;
    cursor: pointer;
    user-select: none;
    box-shadow: 0 0 8px #000;
    color: #eee;
    transition: background 0.3s ease, color 0.3s ease;
  }
  .card.guessed.red {
    background: #b22;
    color: #fff;
    cursor: default;
  }
  .card.guessed.blue {
    background: #228;
    color: #fff;
    cursor: default;
  }
  .card.guessed.neutral {
    background: #555;
    color: #ccc;
    cursor: default;
  }
  .card.guessed.assassin {
    background: #000;
    color: #f33;
    cursor: default;
  }

  .info {
    margin-top: 1rem;
    font-size: 1.2rem;
  }

  .turn-indicator {
    font-weight: 700;
    margin-bottom: 1rem;
    text-align: center;
    font-size: 1.4rem;
  }

  .winner-message {
    font-size: 1.6rem;
    font-weight: 900;
    text-align: center;
    margin-top: 1rem;
    color: #0f0;
  }
</style>
</head>
<body>

<header>لعبة Codenames - مودرن وفخم</header>

<main>
  <section class="room-section">
    <label for="roomNameInput">اسم الغرفة:</label>
    <input id="roomNameInput" type="text" placeholder="اكتب اسم الغرفة هنا" />
    <button id="createRoomBtn">إنشئ الغرفة</button>
    <button id="joinRoomBtn">ادخل الغرفة</button>
  </section>

  <section class="game-section" style="display:none;">
    <div class="turn-indicator" id="turnIndicator">دور: ...</div>
    <div class="board" id="board"></div>
    <div class="winner-message" id="winnerMessage" style="display:none;"></div>
    <button id="startGameBtn" style="margin-top:1rem;">بدء اللعبة</button>
  </section>
</main>

<script>
  // 300 كلمة جاهزة
  const words = [
    "شمس", "قمر", "نجم", "بحر", "صحراء", "رمل", "شجرة", "نهر", "جبل", "سماء",
    "طائرة", "سيارة", "قطار", "قارب", "دراجة", "كتاب", "قلم", "ورقة", "مدرسة", "جامعة",
    "كلب", "قط", "حصان", "فأر", "سمكة", "طاووس", "نسر", "أسد", "نمر", "ذئب",
    "بيت", "شارع", "سوق", "مستشفى", "مطعم", "مطار", "حديقة", "جسر", "برج", "مكتبة",
    "كرة", "ماء", "نار", "هواء", "تراب", "ثلج", "مطر", "ريح", "برق", "رعد",
    "فضة", "ذهب", "حديد", "نحاس", "رصاص", "زنك", "ألمونيوم", "بلاتين", "كوبالت", "نيكل",
    "شاي", "قهوة", "عسل", "سكر", "ملح", "زيت", "خمر", "حليب", "لبن", "تمر",
    "تفاح", "موز", "برتقال", "عنب", "فراولة", "كيوي", "أناناس", "بطيخ", "شمام", "كركديه",
    "كرة القدم", "كرة السلة", "كرة الطائرة", "تنس", "سباحة", "جري", "رماية", "مصارعة", "ملاكمة", "غولف",
    "شعر", "رواية", "قصيدة", "مسرحية", "سينما", "موسيقى", "رسم", "تصوير", "تمثال", "معرض",
    "شمسية", "مظلة", "ساعة", "هاتف", "حاسوب", "كاميرا", "مروحة", "ثلاجة", "ميكروويف", "غسالة",
    "طاولة", "كرسي", "سرير", "خزانة", "باب", "نافذة", "سقف", "حائط", "سجادة", "مصباح",
    "قائد", "جندي", "شرطي", "طبيب", "مهندس", "معلم", "مزارع", "صياد", "نجار", "حداد",
    "وردة", "شجرة", "نبات", "حيوان", "طائر", "سمك", "حشرة", "فقمة", "دب", "ثعلب",
    "قطار", "طائرة", "سفينة", "سيارة", "دراجة", "حافلة", "تاكسي", "ترام", "مروحية", "زورق",
    "نجم", "كوكب", "مجرة", "كون", "فضاء", "قمر", "شمس", "كويكب", "نيزك", "مذنب",
    "خبز", "لحم", "سمك", "خضار", "فاكهة", "حليب", "بيض", "جبن", "زبدة", "عصير",
    "مدينة", "قرية", "عاصمة", "دولة", "قارة", "محافظة", "شارع", "سوق", "مطار", "ميناء",
    "بحر", "نهر", "شلال", "بركان", "صحراء", "غابة", "جبل", "تل", "وادي", "سهول",
    "فيلم", "مسلسل", "برنامج", "مسرحية", "عرض", "حفلة", "موسيقى", "رسم", "فن", "متحف",
    "لغة", "حروف", "كلمات", "جمل", "نص", "قصة", "مقال", "رواية", "قصيدة", "مسرحية",
    "علم", "رياضة", "تاريخ", "جغرافيا", "فلسفة", "رياضيات", "فيزياء", "كيمياء", "بيولوجيا", "حاسوب",
    "برمجة", "تطوير", "تصميم", "شبكات", "أنظمة", "بيانات", "ذكاء", "اصطناعي", "تعلم", "آلة",
    "صداقة", "حب", "كراهية", "سلام", "حرب", "عدل", "ظلم", "حرية", "حق", "واجب",
    "سماء", "غيم", "ريح", "مطر", "ثلج", "برد", "حر", "صيف", "شتاء", "ربيع",
    "رجل", "امرأة", "طفل", "شاب", "مسن", "عائلة", "صديق", "جار", "زميل", "مدير",
    "بحر", "شاطئ", "موج", "صخرة", "رمل", "سمك", "طائر", "قارب", "مرفأ", "موجة",
    "نجاح", "فشل", "فرح", "حزن", "غضب", "هدوء", "خوف", "شجاعة", "صدق", "كذب",
    "سماء", "نجم", "قمر", "شمس", "غيوم", "ريح", "مطر", "ثلج", "برق", "رعد",
    "كرة", "مضرب", "شبكة", "ملعب", "حكم", "لاعب", "جمهور", "فريق", "مدرب", "بطولة",
    "كتاب", "مكتبة", "مدرسة", "جامعة", "صف", "درس", "معلّم", "طالب", "اختبار", "نجاح"
  ];

  function shuffle(array) {
    let currentIndex = array.length, randomIndex;

    while (currentIndex != 0) {
      randomIndex = Math.floor(Math.random() * currentIndex);
      currentIndex--;
      [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
    }

    return array;
  }

  // بيانات اللعبة
  let roomName = null;
  let gameData = {
    players: [],
    started: false,
    board: null,
    turn: null,
    passed: false,
    winner: null,
  };

  const roomInput = document.getElementById('roomNameInput');
  const createRoomBtn = document.getElementById('createRoomBtn');
  const joinRoomBtn = document.getElementById('joinRoomBtn');
  const startGameBtn = document.getElementById('startGameBtn');
  const boardDiv = document.getElementById('board');
  const turnIndicator = document.getElementById('turnIndicator');
  const winnerMessage = document.getElementById('winnerMessage');
  const gameSection = document.querySelector('.game-section');

  // إنشاء غرفة جديدة
  createRoomBtn.onclick = () => {
    if (!roomInput.value.trim()) {
      alert('اكتب اسم الغرفة عشان تنشئها!');
      return;
    }
    roomName = roomInput.value.trim();
    gameData = {
      players: [],
      started: false,
      board: null,
      turn: null,
      passed: false,
      winner: null,
    };
    alert(`الغرفة "${roomName}" انشئت، الحين تقدر تدخلها!`);
    gameSection.style.display = 'block';
    roomInput.disabled = true;
    createRoomBtn.disabled = true;
    joinRoomBtn.disabled = true;
    updateUI();
  };

  // دخول غرفة
  joinRoomBtn.onclick = () => {
    if (!roomInput.value.trim()) {
      alert('اكتب اسم الغرفة عشان تدخلها!');
      return;
    }
    roomName = roomInput.value.trim();
    // ما عندنا سيرفر حقيقي، فبنعتبر الغرفة موجودة ونفتحها (تطوير مستقبلي)
    alert(`دخلت الغرفة "${roomName}"`);
    gameSection.style.display = 'block';
    roomInput.disabled = true;
    createRoomBtn.disabled = true;
    joinRoomBtn.disabled = true;
    updateUI();
  };

  // بدء اللعبة
  startGameBtn.onclick = () => {
    if (!roomName) {
      alert('لازم تدخل غرفة أول!');
      return;
    }
    if (gameData.started) {
      alert('اللعبة شغالة! لا تعيد البدء.');
      return;
    }
    // نبدأ اللعبة
    const shuffledWords = shuffle(words.slice()).slice(0, 25);
    const colors = [];
    for (let i = 0; i < 9; i++) colors.push("red");
    for (let i = 0; i < 8; i++) colors.push("blue");
    for (let i = 0; i < 7; i++) colors.push("neutral");
    colors.push("assassin");
    shuffle(colors);

    const board = {};
    shuffledWords.forEach((word, idx) => {
      board[word] = {
        color: colors[idx],
        guessed: false
      };
    });

    gameData.board = board;
    gameData.started = true;
    gameData.turn = "red";
    gameData.winner = null;
    gameData.passed = false;
    updateUI();
  };

  // الضغط على كرت
  boardDiv.onclick = e => {
    if (!gameData.started || gameData.winner) return;
    if (!e.target.classList.contains('card')) return;

    const word = e.target.dataset.word;
    if (gameData.board[word].guessed) return;

    gameData.board[word].guessed = true;

    // إذا الكرت قاتل، الفريق الخاسر يتحدد فوراً
    if (gameData.board[word].color === "assassin") {
      gameData.winner = gameData.turn === "red" ? "blue" : "red";
      updateUI();
      return;
    }

    // تحقق الفوز
    const redLeft = Object.values(gameData.board).filter(c => c.color === "red" && !c.guessed).length;
    const blueLeft = Object.values(gameData.board).filter(c => c.color === "blue" && !c.guessed).length;

    if (redLeft === 0) gameData.winner = "red";
    if (blueLeft === 0) gameData.winner = "blue";

    // تبديل الدور إذا ما كان اللون مطابق للكرت
    if (gameData.board[word].color !== gameData.turn) {
      gameData.turn = gameData.turn === "red" ? "blue" : "red";
    }

    updateUI();
  };

  function updateUI() {
    // تحديث لوحة الكروت
    boardDiv.innerHTML = '';
    if (gameData.board) {
      for (const [word, info] of Object.entries(gameData.board)) {
        const card = document.createElement('div');
        card.classList.add('card');
        if (info.guessed) card.classList.add('guessed', info.color);
        card.textContent = word;
        card.dataset.word = word;
        boardDiv.appendChild(card);
      }
    }

    // تحديث دور الفريق
    if (gameData.winner) {
      turnIndicator.textContent = '';
      winnerMessage.style.display = 'block';
      winnerMessage.textContent = `الفريق الفايز: ${gameData.winner === 'red' ? 'الأحمر ❤️' : 'الأزرق 💙'}`;
    } else if (gameData.started) {
      winnerMessage.style.display = 'none';
      turnIndicator.textContent = `دور الفريق: ${gameData.turn === 'red' ? 'الأحمر ❤️' : 'الأزرق 💙'}`;
    } else {
      winnerMessage.style.display = 'none';
      turnIndicator.textContent = 'اللعبة لم تبدأ بعد';
    }
  }
</script>

</body>
</html>
