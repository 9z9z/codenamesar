<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Codenames Online - كود نايمز</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #fff;
      overflow-x: hidden;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 2rem;
      animation: fadeInDown 0.8s ease-out;
    }

    .header h1 {
      font-size: 3rem;
      font-weight: 700;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      margin-bottom: 0.5rem;
      background: linear-gradient(45deg, #fff, #f0f0f0);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header p {
      font-size: 1.2rem;
      opacity: 0.9;
    }

    .game-container {
      display: grid;
      grid-template-columns: 1fr 350px;
      gap: 2rem;
      margin-bottom: 2rem;
    }

    .main-game {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 2rem;
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    }

    .sidebar {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .panel {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 1.5rem;
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    }

    .panel h3 {
      margin-bottom: 1rem;
      color: #fff;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    }

    .form-group {
      margin-bottom: 1rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: #fff;
    }

    .form-group input, .form-group select {
      width: 100%;
      padding: 0.75rem;
      border: none;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.9);
      color: #333;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .form-group input:focus, .form-group select:focus {
      outline: none;
      background: rgba(255, 255, 255, 1);
      box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.3);
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 10px;
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn-primary {
      background: linear-gradient(45deg, #4CAF50, #45a049);
    }

    .btn-secondary {
      background: linear-gradient(45deg, #2196F3, #1976D2);
    }

    .btn-danger {
      background: linear-gradient(45deg, #f44336, #d32f2f);
    }

    .game-board {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
      margin: 2rem 0;
    }

    .card {
      aspect-ratio: 1.5;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.9rem;
      color: #333;
      cursor: pointer;
      transition: all 0.3s ease;
      user-select: none;
      border: 2px solid transparent;
      position: relative;
      overflow: hidden;
    }

    .card:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    }

    .card.red {
      background: linear-gradient(135deg, #ff6b6b, #ee5a24);
      color: white;
      border-color: #ff4757;
    }

    .card.blue {
      background: linear-gradient(135deg, #4834d4, #341f97);
      color: white;
      border-color: #3742fa;
    }

    .card.neutral {
      background: linear-gradient(135deg, #a4b0be, #747d8c);
      color: white;
      border-color: #57606f;
    }

    .card.assassin {
      background: linear-gradient(135deg, #2c2c54, #1a1a2e);
      color: #ff3838;
      border-color: #ff3838;
      box-shadow: 0 0 20px rgba(255, 56, 56, 0.3);
    }

    .card.guessed {
      opacity: 0.6;
      transform: scale(0.95);
      cursor: default;
    }

    .card.guessed::after {
      content: '✓';
      position: absolute;
      top: 5px;
      right: 5px;
      font-size: 1.2rem;
      color: #fff;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    }

    .game-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
    }

    .team-score {
      text-align: center;
    }

    .team-score .score {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .team-score.red .score {
      color: #ff6b6b;
    }

    .team-score.blue .score {
      color: #4834d4;
    }

    .turn-indicator {
      font-size: 1.2rem;
      font-weight: 600;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.2);
    }

    .chat-container {
      height: 300px;
      display: flex;
      flex-direction: column;
    }

    .chat-messages {
      flex: 1;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 10px;
      padding: 1rem;
      overflow-y: auto;
      margin-bottom: 1rem;
    }

    .chat-message {
      margin-bottom: 0.5rem;
      padding: 0.5rem;
      border-radius: 5px;
      background: rgba(255, 255, 255, 0.1);
    }

    .chat-message .username {
      font-weight: 600;
      color: #ffd700;
    }

    .chat-input {
      display: flex;
      gap: 0.5rem;
    }

    .chat-input input {
      flex: 1;
      padding: 0.5rem;
      border: none;
      border-radius: 5px;
      background: rgba(255, 255, 255, 0.9);
      color: #333;
    }

    .players-list {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 10px;
      padding: 1rem;
    }

    .player-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem;
      margin-bottom: 0.5rem;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 5px;
    }

    .player-role {
      font-size: 0.8rem;
      padding: 0.2rem 0.5rem;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.2);
    }

    .controls {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
    }

    .winner-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .winner-content {
      background: white;
      padding: 2rem;
      border-radius: 20px;
      text-align: center;
      color: #333;
      max-width: 400px;
    }

    .winner-content h2 {
      font-size: 2rem;
      margin-bottom: 1rem;
    }

    .hidden {
      display: none;
    }

    .lobby-screen {
      text-align: center;
      padding: 2rem;
    }

    .lobby-screen .btn {
      margin: 0.5rem;
    }

    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse {
      0% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.05);
      }
      100% {
        transform: scale(1);
      }
    }

    .card.highlight {
      animation: pulse 0.5s ease-in-out;
    }

    @media (max-width: 768px) {
      .game-container {
        grid-template-columns: 1fr;
      }
      
      .header h1 {
        font-size: 2rem;
      }
      
      .game-board {
        grid-template-columns: repeat(5, 1fr);
        gap: 5px;
      }
      
      .card {
        font-size: 0.8rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>🎯 كود نايمز أونلاين</h1>
      <p>لعبة التخمين والذكاء الجماعية</p>
    </div>

    <!-- Lobby Screen -->
    <div id="lobbyScreen" class="lobby-screen">
      <div class="panel">
        <h3>انضم إلى اللعبة</h3>
        <div class="form-group">
          <label for="playerName">اسم اللاعب:</label>
          <input type="text" id="playerName" placeholder="أدخل اسمك">
        </div>
        <div class="form-group">
          <label for="roomCode">كود الغرفة:</label>
          <input type="text" id="roomCode" placeholder="أدخل كود الغرفة">
        </div>
        <div class="form-group">
          <label for="playerRole">دورك في اللعبة:</label>
          <select id="playerRole">
            <option value="field_red">عميل ميداني - الفريق الأحمر</option>
            <option value="spy_red">رئيس الجواسيس - الفريق الأحمر</option>
            <option value="field_blue">عميل ميداني - الفريق الأزرق</option>
            <option value="spy_blue">رئيس الجواسيس - الفريق الأزرق</option>
          </select>
        </div>
        <button class="btn btn-primary" onclick="joinGame()">انضم إلى اللعبة</button>
        <button class="btn btn-secondary" onclick="createRoom()">إنشاء غرفة جديدة</button>
      </div>
    </div>

    <!-- Game Screen -->
    <div id="gameScreen" class="game-container hidden">
      <div class="main-game">
        <div class="game-info">
          <div class="team-score red">
            <div class="score" id="redScore">9</div>
            <div>الفريق الأحمر</div>
          </div>
          <div class="turn-indicator" id="turnIndicator">
            دور الفريق الأحمر
          </div>
          <div class="team-score blue">
            <div class="score" id="blueScore">8</div>
            <div>الفريق الأزرق</div>
          </div>
        </div>
        
        <div class="game-board" id="gameBoard">
          <!-- Cards will be generated here -->
        </div>
        
        <div class="controls">
          <button class="btn btn-secondary" id="spymasterBtn" onclick="toggleSpymaster()">
            تشغيل وضع رئيس الجواسيس
          </button>
          <button class="btn btn-danger" onclick="passTurn()">
            تمرير الدور
          </button>
          <button class="btn btn-primary" onclick="newGame()">
            لعبة جديدة
          </button>
        </div>
      </div>

      <div class="sidebar">
        <div class="panel">
          <h3>اللاعبون</h3>
          <div class="players-list" id="playersList">
            <!-- Players will be listed here -->
          </div>
        </div>

        <div class="panel">
          <h3>الدردشة</h3>
          <div class="chat-container">
            <div class="chat-messages" id="chatMessages">
              <!-- Chat messages will appear here -->
            </div>
            <div class="chat-input">
              <input type="text" id="chatInput" placeholder="اكتب رسالة...">
              <button class="btn" onclick="sendMessage()">إرسال</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Winner Modal -->
    <div id="winnerModal" class="winner-modal hidden">
      <div class="winner-content">
        <h2 id="winnerText">🎉 الفريق الأحمر يفوز!</h2>
        <p>تهانينا على الفوز!</p>
        <button class="btn btn-primary" onclick="closeWinnerModal()">إغلاق</button>
        <button class="btn btn-secondary" onclick="newGame()">لعبة جديدة</button>
      </div>
    </div>
  </div>

  <script>
    // Game state
    let gameState = {
      players: {},
      cards: [],
      currentTurn: 'red',
      redScore: 9,
      blueScore: 8,
      winner: null,
      spymasterMode: false,
      currentPlayer: null,
      roomCode: null
    };

    // Sample Arabic words for the game
    const arabicWords = [
      'شمس', 'قمر', 'نجم', 'بحر', 'جبل', 'نهر', 'شجرة', 'وردة', 'طائر', 'قط',
      'كلب', 'حصان', 'سيارة', 'طائرة', 'قطار', 'بيت', 'مدرسة', 'مسجد', 'مكتبة', 'سوق',
      'طبيب', 'مهندس', 'معلم', 'طباخ', 'رسام', 'كتاب', 'قلم', 'ورقة', 'حاسوب', 'هاتف',
      'تلفاز', 'راديو', 'موسيقى', 'فيلم', 'لعبة', 'كرة', 'ملعب', 'حديقة', 'مقهى', 'مطعم',
      'خبز', 'ماء', 'شاي', 'قهوة', 'عسل', 'تفاح', 'برتقال', 'موز', 'عنب', 'فراولة'
    ];

    // Initialize game
    function initializeGame() {
      generateCards();
      updateDisplay();
      addChatMessage('النظام', 'مرحباً بكم في لعبة كود نايمز!');
    }

    // Generate random cards
    function generateCards() {
      const shuffledWords = [...arabicWords].sort(() => 0.5 - Math.random()).slice(0, 25);
      const colors = ['red', 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red',
                     'blue', 'blue', 'blue', 'blue', 'blue', 'blue', 'blue', 'blue',
                     'neutral', 'neutral', 'neutral', 'neutral', 'neutral', 'neutral', 'neutral',
                     'assassin'];
      
      // Shuffle colors
      for (let i = colors.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [colors[i], colors[j]] = [colors[j], colors[i]];
      }

      gameState.cards = shuffledWords.map((word, index) => ({
        word: word,
        color: colors[index],
        revealed: false,
        id: index
      }));
    }

    // Create room
    function createRoom() {
      const roomCode = Math.random().toString(36).substring(2, 8).toUpperCase();
      document.getElementById('roomCode').value = roomCode;
      gameState.roomCode = roomCode;
      addChatMessage('النظام', `تم إنشاء غرفة جديدة: ${roomCode}`);
    }

    // Join game
    function joinGame() {
      const playerName = document.getElementById('playerName').value.trim();
      const roomCode = document.getElementById('roomCode').value.trim();
      const playerRole = document.getElementById('playerRole').value;

      if (!playerName || !roomCode) {
        alert('يرجى إدخال اسم اللاعب وكود الغرفة');
        return;
      }

      gameState.currentPlayer = playerName;
      gameState.roomCode = roomCode;
      gameState.players[playerName] = {
        name: playerName,
        role: playerRole,
        team: playerRole.includes('red') ? 'red' : 'blue',
        type: playerRole.includes('spy') ? 'spy' : 'field'
      };

      document.getElementById('lobbyScreen').classList.add('hidden');
      document.getElementById('gameScreen').classList.remove('hidden');
      
      initializeGame();
      addChatMessage('النظام', `انضم ${playerName} إلى اللعبة`);
    }

    // Update display
    function updateDisplay() {
      updateBoard();
      updateScores();
      updateTurnIndicator();
      updatePlayersList();
    }

    // Update game board
    function updateBoard() {
      const board = document.getElementById('gameBoard');
      board.innerHTML = '';

      gameState.cards.forEach(card => {
        const cardElement = document.createElement('div');
        cardElement.className = 'card';
        cardElement.textContent = card.word;
        cardElement.onclick = () => selectCard(card.id);

        if (card.revealed) {
          cardElement.classList.add('guessed', card.color);
        } else if (gameState.spymasterMode && isSpymaster()) {
          cardElement.classList.add(card.color);
        }

        board.appendChild(cardElement);
      });
    }

    // Select card
    function selectCard(cardId) {
      const card = gameState.cards[cardId];
      if (card.revealed || gameState.winner) return;

      const currentPlayer = gameState.players[gameState.currentPlayer];
      if (!currentPlayer) return;

      // Only field operatives can select cards
      if (currentPlayer.type === 'spy') {
        alert('رئيس الجواسيس لا يمكنه اختيار البطاقات');
        return;
      }

      // Check if it's the player's team turn
      if (currentPlayer.team !== gameState.currentTurn) {
        alert('ليس دور فريقك');
        return;
      }

      card.revealed = true;
      
      // Add highlight effect
      const cardElement = document.querySelectorAll('.card')[cardId];
      cardElement.classList.add('highlight');

      // Check card type and handle accordingly
      if (card.color === 'assassin') {
        gameState.winner = currentPlayer.team === 'red' ? 'blue' : 'red';
        addChatMessage('النظام', `💀 تم اختيار بطاقة القاتل! فاز الفريق ${gameState.winner === 'red' ? 'الأحمر' : 'الأزرق'}`);
        showWinner();
      } else if (card.color === currentPlayer.team) {
        // Correct team card
        if (currentPlayer.team === 'red') {
          gameState.redScore--;
        } else {
          gameState.blueScore--;
        }
        addChatMessage('النظام', `✅ ${currentPlayer.name} اختار بطاقة صحيحة: ${card.word}`);
        
        // Check for win
        if (gameState.redScore === 0) {
          gameState.winner = 'red';
          showWinner();
        } else if (gameState.blueScore === 0) {
          gameState.winner = 'blue';
          showWinner();
        }
      } else {
        // Wrong team card or neutral
        addChatMessage('النظام', `❌ ${currentPlayer.name} اختار بطاقة خاطئة: ${card.word}`);
        switchTurn();
      }

      updateDisplay();
    }

    // Switch turn
    function switchTurn() {
      gameState.currentTurn = gameState.currentTurn === 'red' ? 'blue' : 'red';
    }

    // Pass turn
    function passTurn() {
      const currentPlayer = gameState.players[gameState.currentPlayer];
      if (!currentPlayer) return;

      if (currentPlayer.team !== gameState.currentTurn) {
        alert('ليس دور فريقك');
        return;
      }

      switchTurn();
      addChatMessage('النظام', `${currentPlayer.name} مرر الدور`);
      updateDisplay();
    }

    // Toggle spymaster mode
    function toggleSpymaster() {
      const currentPlayer = gameState.players[gameState.currentPlayer];
      if (!currentPlayer) return;

      if (currentPlayer.type !== 'spy') {
        alert('فقط رئيس الجواسيس يمكنه استخدام هذا الوضع');
        return;
      }

      gameState.spymasterMode = !gameState.spymasterMode;
      const btn = document.getElementById('spymasterBtn');
      btn.textContent = gameState.spymasterMode ? 'إيقاف وضع رئيس الجواسيس' : 'تشغيل وضع رئيس الجواسيس';
      updateBoard();
    }

    // Check if current player is spymaster
    function isSpymaster() {
      const currentPlayer = gameState.players[gameState.currentPlayer];
      return currentPlayer && currentPlayer.type === 'spy';
    }

    // Update scores
    function updateScores() {
      document.getElementById('redScore').textContent = gameState.redScore;
      document.getElementById('blueScore').textContent = gameState.blueScore;
    }

    // Update turn indicator
    function updateTurnIndicator() {
      const indicator = document.getElementById('turnIndicator');
      indicator.textContent = `دور الفريق ${gameState.currentTurn === 'red' ? 'الأحمر' : 'الأزرق'}`;
    }

    // Update players list
    function updatePlayersList() {
      const list = document.getElementById('playersList');
      list.innerHTML = '';

      Object.values(gameState.players).forEach(player => {
        const playerDiv = document.createElement('div');
        playerDiv.className = 'player-item';
        
        const nameSpan = document.createElement('span');
        nameSpan.textContent = player.name;
        
        const roleSpan = document.createElement('span');
        roleSpan.className = 'player-role';
        roleSpan.textContent = `${player.type === 'spy' ? 'رئيس جواسيس' : 'عميل ميداني'} - ${player.team === 'red' ? 'أحمر' : 'أزرق'}`;
        
        playerDiv.appendChild(nameSpan);
        playerDiv.appendChild(roleSpan);
        list.appendChild(playerDiv);
      });
    }

    // Show winner
    function showWinner() {
      const modal = document.getElementById('winnerModal');
      const winnerText = document.getElementById('winnerText');
      winnerText.textContent = `🎉 الفريق ${gameState.winner === 'red' ? 'الأحمر' : 'الأزرق'} يفوز!`;
      modal.classList.remove('hidden');
    }

    // Close winner modal
    function closeWinnerModal() {
      document.getElementById('winnerModal').classList.add('hidden');
    }

    // New game
    function newGame() {
      gameState.cards = [];
      gameState.currentTurn = 'red';
      gameState.redScore = 9;
      gameState.blueScore = 8;
      gameState.winner = null;
      gameState.spymasterMode = false;
      
      closeWinnerModal();
      generateCards();
      updateDisplay();
      addChatMessage('النظام', 'بدأت لعبة جديدة!');
    }

    // Chat functionality
    function sendMessage() {
      const input = document.getElementById('chatInput');
      const message = input.value.trim();
      
      if (message && gameState.currentPlayer) {
        addChatMessage(gameState.currentPlayer, message);
        input.value = '';
      }
    }

    function addChatMessage(sender, message) {
      const chatMessages = document.getElementById('chatMessages');
      const messageDiv = document.createElement('div');
      messageDiv.className = 'chat-message';
      
      const time = new Date().toLocaleTimeString('ar-SA', { 
        hour: '2-digit', 
        minute: '2-digit' 
      });
      
      messageDiv.innerHTML = `
        <span class="username">${sender}</span>
        <span class="time">${time}</span>
        <div>${message}</div>
      `;
      
      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Event listeners
    document.getElementById('chatInput').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        sendMessage();
      }
    });

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
    });
  </script>
</body>
</html>
