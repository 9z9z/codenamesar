<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Codenames Online - ÙƒÙˆØ¯ Ù†Ø§ÙŠÙ…Ø²</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #fff;
      overflow-x: hidden;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 2rem;
      animation: fadeInDown 0.8s ease-out;
    }

    .header h1 {
      font-size: 3rem;
      font-weight: 700;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      margin-bottom: 0.5rem;
      background: linear-gradient(45deg, #fff, #f0f0f0);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header p {
      font-size: 1.2rem;
      opacity: 0.9;
    }

    .game-container {
      display: grid;
      grid-template-columns: 1fr 350px;
      gap: 2rem;
      margin-bottom: 2rem;
    }

    .main-game {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 2rem;
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    }

    .sidebar {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .panel {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 1.5rem;
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    }

    .panel h3 {
      margin-bottom: 1rem;
      color: #fff;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    }

    .form-group {
      margin-bottom: 1rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: #fff;
    }

    .form-group input, .form-group select {
      width: 100%;
      padding: 0.75rem;
      border: none;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.9);
      color: #333;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .form-group input:focus, .form-group select:focus {
      outline: none;
      background: rgba(255, 255, 255, 1);
      box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.3);
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 10px;
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn-primary {
      background: linear-gradient(45deg, #4CAF50, #45a049);
    }

    .btn-secondary {
      background: linear-gradient(45deg, #2196F3, #1976D2);
    }

    .btn-danger {
      background: linear-gradient(45deg, #f44336, #d32f2f);
    }

    .game-board {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
      margin: 2rem 0;
    }

    .card {
      aspect-ratio: 1.5;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 0.9rem;
      color: #333;
      cursor: pointer;
      transition: all 0.3s ease;
      user-select: none;
      border: 2px solid transparent;
      position: relative;
      overflow: hidden;
    }

    .card:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    }

    .card.red {
      background: linear-gradient(135deg, #ff6b6b, #ee5a24);
      color: white;
      border-color: #ff4757;
    }

    .card.blue {
      background: linear-gradient(135deg, #4834d4, #341f97);
      color: white;
      border-color: #3742fa;
    }

    .card.neutral {
      background: linear-gradient(135deg, #a4b0be, #747d8c);
      color: white;
      border-color: #57606f;
    }

    .card.assassin {
      background: linear-gradient(135deg, #2c2c54, #1a1a2e);
      color: #ff3838;
      border-color: #ff3838;
      box-shadow: 0 0 20px rgba(255, 56, 56, 0.3);
    }

    .card.guessed {
      opacity: 0.6;
      transform: scale(0.95);
      cursor: default;
    }

    .card.guessed::after {
      content: 'âœ“';
      position: absolute;
      top: 5px;
      right: 5px;
      font-size: 1.2rem;
      color: #fff;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    }

    .game-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
    }

    .team-score {
      text-align: center;
    }

    .team-score .score {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .team-score.red .score {
      color: #ff6b6b;
    }

    .team-score.blue .score {
      color: #4834d4;
    }

    .turn-indicator {
      font-size: 1.2rem;
      font-weight: 600;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.2);
    }

    .chat-container {
      height: 300px;
      display: flex;
      flex-direction: column;
    }

    .chat-messages {
      flex: 1;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 10px;
      padding: 1rem;
      overflow-y: auto;
      margin-bottom: 1rem;
    }

    .chat-message {
      margin-bottom: 0.5rem;
      padding: 0.5rem;
      border-radius: 5px;
      background: rgba(255, 255, 255, 0.1);
    }

    .chat-message .username {
      font-weight: 600;
      color: #ffd700;
    }

    .chat-input {
      display: flex;
      gap: 0.5rem;
    }

    .chat-input input {
      flex: 1;
      padding: 0.5rem;
      border: none;
      border-radius: 5px;
      background: rgba(255, 255, 255, 0.9);
      color: #333;
    }

    .players-list {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 10px;
      padding: 1rem;
    }

    .player-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem;
      margin-bottom: 0.5rem;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 5px;
    }

    .player-role {
      font-size: 0.8rem;
      padding: 0.2rem 0.5rem;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.2);
    }

    .controls {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
    }

    .winner-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .winner-content {
      background: white;
      padding: 2rem;
      border-radius: 20px;
      text-align: center;
      color: #333;
      max-width: 400px;
    }

    .winner-content h2 {
      font-size: 2rem;
      margin-bottom: 1rem;
    }

    .hidden {
      display: none;
    }

    .lobby-screen {
      text-align: center;
      padding: 2rem;
    }

    .lobby-screen .btn {
      margin: 0.5rem;
    }

    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse {
      0% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.05);
      }
      100% {
        transform: scale(1);
      }
    }

    .card.highlight {
      animation: pulse 0.5s ease-in-out;
    }

    @media (max-width: 768px) {
      .game-container {
        grid-template-columns: 1fr;
      }
      
      .header h1 {
        font-size: 2rem;
      }
      
      .game-board {
        grid-template-columns: repeat(5, 1fr);
        gap: 5px;
      }
      
      .card {
        font-size: 0.8rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ¯ ÙƒÙˆØ¯ Ù†Ø§ÙŠÙ…Ø² Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†</h1>
      <p>Ù„Ø¹Ø¨Ø© Ø§Ù„ØªØ®Ù…ÙŠÙ† ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©</p>
    </div>

    <!-- Lobby Screen -->
    <div id="lobbyScreen" class="lobby-screen">
      <div class="panel">
        <h3>Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø¹Ø¨Ø©</h3>
        <div class="form-group">
          <label for="playerName">Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨:</label>
          <input type="text" id="playerName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ">
        </div>
        <div class="form-group">
          <label for="roomCode">ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©:</label>
          <input type="text" id="roomCode" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©">
        </div>
        <div class="form-group">
          <label for="playerRole">Ø¯ÙˆØ±Ùƒ ÙÙŠ Ø§Ù„Ù„Ø¹Ø¨Ø©:</label>
          <select id="playerRole">
            <option value="field_red">Ø¹Ù…ÙŠÙ„ Ù…ÙŠØ¯Ø§Ù†ÙŠ - Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±</option>
            <option value="spy_red">Ø±Ø¦ÙŠØ³ Ø§Ù„Ø¬ÙˆØ§Ø³ÙŠØ³ - Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±</option>
            <option value="field_blue">Ø¹Ù…ÙŠÙ„ Ù…ÙŠØ¯Ø§Ù†ÙŠ - Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚</option>
            <option value="spy_blue">Ø±Ø¦ÙŠØ³ Ø§Ù„Ø¬ÙˆØ§Ø³ÙŠØ³ - Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚</option>
          </select>
        </div>
        <button class="btn btn-primary" onclick="joinGame()">Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
        <button class="btn btn-secondary" onclick="createRoom()">Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ© Ø¬Ø¯ÙŠØ¯Ø©</button>
      </div>
    </div>

    <!-- Game Screen -->
    <div id="gameScreen" class="game-container hidden">
      <div class="main-game">
        <div class="game-info">
          <div class="team-score red">
            <div class="score" id="redScore">9</div>
            <div>Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±</div>
          </div>
          <div class="turn-indicator" id="turnIndicator">
            Ø¯ÙˆØ± Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±
          </div>
          <div class="team-score blue">
            <div class="score" id="blueScore">8</div>
            <div>Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚</div>
          </div>
        </div>
        
        <div class="game-board" id="gameBoard">
          <!-- Cards will be generated here -->
        </div>
        
        <div class="controls">
          <button class="btn btn-secondary" id="spymasterBtn" onclick="toggleSpymaster()">
            ØªØ´ØºÙŠÙ„ ÙˆØ¶Ø¹ Ø±Ø¦ÙŠØ³ Ø§Ù„Ø¬ÙˆØ§Ø³ÙŠØ³
          </button>
          <button class="btn btn-danger" onclick="passTurn()">
            ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø¯ÙˆØ±
          </button>
          <button class="btn btn-primary" onclick="newGame()">
            Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©
          </button>
        </div>
      </div>

      <div class="sidebar">
        <div class="panel">
          <h3>Ø§Ù„Ù„Ø§Ø¹Ø¨ÙˆÙ†</h3>
          <div class="players-list" id="playersList">
            <!-- Players will be listed here -->
          </div>
        </div>

        <div class="panel">
          <h3>Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©</h3>
          <div class="chat-container">
            <div class="chat-messages" id="chatMessages">
              <!-- Chat messages will appear here -->
            </div>
            <div class="chat-input">
              <input type="text" id="chatInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©...">
              <button class="btn" onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Winner Modal -->
    <div id="winnerModal" class="winner-modal hidden">
      <div class="winner-content">
        <h2 id="winnerText">ğŸ‰ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø± ÙŠÙÙˆØ²!</h2>
        <p>ØªÙ‡Ø§Ù†ÙŠÙ†Ø§ Ø¹Ù„Ù‰ Ø§Ù„ÙÙˆØ²!</p>
        <button class="btn btn-primary" onclick="closeWinnerModal()">Ø¥ØºÙ„Ø§Ù‚</button>
        <button class="btn btn-secondary" onclick="newGame()">Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
      </div>
    </div>
  </div>

  <script>
    // Game state
    let gameState = {
      players: {},
      cards: [],
      currentTurn: 'red',
      redScore: 9,
      blueScore: 8,
      winner: null,
      spymasterMode: false,
      currentPlayer: null,
      roomCode: null
    };

    // Sample Arabic words for the game
    const arabicWords = [
      'Ø´Ù…Ø³', 'Ù‚Ù…Ø±', 'Ù†Ø¬Ù…', 'Ø¨Ø­Ø±', 'Ø¬Ø¨Ù„', 'Ù†Ù‡Ø±', 'Ø´Ø¬Ø±Ø©', 'ÙˆØ±Ø¯Ø©', 'Ø·Ø§Ø¦Ø±', 'Ù‚Ø·',
      'ÙƒÙ„Ø¨', 'Ø­ØµØ§Ù†', 'Ø³ÙŠØ§Ø±Ø©', 'Ø·Ø§Ø¦Ø±Ø©', 'Ù‚Ø·Ø§Ø±', 'Ø¨ÙŠØª', 'Ù…Ø¯Ø±Ø³Ø©', 'Ù…Ø³Ø¬Ø¯', 'Ù…ÙƒØªØ¨Ø©', 'Ø³ÙˆÙ‚',
      'Ø·Ø¨ÙŠØ¨', 'Ù…Ù‡Ù†Ø¯Ø³', 'Ù…Ø¹Ù„Ù…', 'Ø·Ø¨Ø§Ø®', 'Ø±Ø³Ø§Ù…', 'ÙƒØªØ§Ø¨', 'Ù‚Ù„Ù…', 'ÙˆØ±Ù‚Ø©', 'Ø­Ø§Ø³ÙˆØ¨', 'Ù‡Ø§ØªÙ',
      'ØªÙ„ÙØ§Ø²', 'Ø±Ø§Ø¯ÙŠÙˆ', 'Ù…ÙˆØ³ÙŠÙ‚Ù‰', 'ÙÙŠÙ„Ù…', 'Ù„Ø¹Ø¨Ø©', 'ÙƒØ±Ø©', 'Ù…Ù„Ø¹Ø¨', 'Ø­Ø¯ÙŠÙ‚Ø©', 'Ù…Ù‚Ù‡Ù‰', 'Ù…Ø·Ø¹Ù…',
      'Ø®Ø¨Ø²', 'Ù…Ø§Ø¡', 'Ø´Ø§ÙŠ', 'Ù‚Ù‡ÙˆØ©', 'Ø¹Ø³Ù„', 'ØªÙØ§Ø­', 'Ø¨Ø±ØªÙ‚Ø§Ù„', 'Ù…ÙˆØ²', 'Ø¹Ù†Ø¨', 'ÙØ±Ø§ÙˆÙ„Ø©'
    ];

    // Initialize game
    function initializeGame() {
      generateCards();
      updateDisplay();
      addChatMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', 'Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒÙ… ÙÙŠ Ù„Ø¹Ø¨Ø© ÙƒÙˆØ¯ Ù†Ø§ÙŠÙ…Ø²!');
    }

    // Generate random cards
    function generateCards() {
      const shuffledWords = [...arabicWords].sort(() => 0.5 - Math.random()).slice(0, 25);
      const colors = ['red', 'red', 'red', 'red', 'red', 'red', 'red', 'red', 'red',
                     'blue', 'blue', 'blue', 'blue', 'blue', 'blue', 'blue', 'blue',
                     'neutral', 'neutral', 'neutral', 'neutral', 'neutral', 'neutral', 'neutral',
                     'assassin'];
      
      // Shuffle colors
      for (let i = colors.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [colors[i], colors[j]] = [colors[j], colors[i]];
      }

      gameState.cards = shuffledWords.map((word, index) => ({
        word: word,
        color: colors[index],
        revealed: false,
        id: index
      }));
    }

    // Create room
    function createRoom() {
      const roomCode = Math.random().toString(36).substring(2, 8).toUpperCase();
      document.getElementById('roomCode').value = roomCode;
      gameState.roomCode = roomCode;
      addChatMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', `ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ© Ø¬Ø¯ÙŠØ¯Ø©: ${roomCode}`);
    }

    // Join game
    function joinGame() {
      const playerName = document.getElementById('playerName').value.trim();
      const roomCode = document.getElementById('roomCode').value.trim();
      const playerRole = document.getElementById('playerRole').value;

      if (!playerName || !roomCode) {
        alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙˆÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©');
        return;
      }

      gameState.currentPlayer = playerName;
      gameState.roomCode = roomCode;
      gameState.players[playerName] = {
        name: playerName,
        role: playerRole,
        team: playerRole.includes('red') ? 'red' : 'blue',
        type: playerRole.includes('spy') ? 'spy' : 'field'
      };

      document.getElementById('lobbyScreen').classList.add('hidden');
      document.getElementById('gameScreen').classList.remove('hidden');
      
      initializeGame();
      addChatMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', `Ø§Ù†Ø¶Ù… ${playerName} Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø¹Ø¨Ø©`);
    }

    // Update display
    function updateDisplay() {
      updateBoard();
      updateScores();
      updateTurnIndicator();
      updatePlayersList();
    }

    // Update game board
    function updateBoard() {
      const board = document.getElementById('gameBoard');
      board.innerHTML = '';

      gameState.cards.forEach(card => {
        const cardElement = document.createElement('div');
        cardElement.className = 'card';
        cardElement.textContent = card.word;
        cardElement.onclick = () => selectCard(card.id);

        if (card.revealed) {
          cardElement.classList.add('guessed', card.color);
        } else if (gameState.spymasterMode && isSpymaster()) {
          cardElement.classList.add(card.color);
        }

        board.appendChild(cardElement);
      });
    }

    // Select card
    function selectCard(cardId) {
      const card = gameState.cards[cardId];
      if (card.revealed || gameState.winner) return;

      const currentPlayer = gameState.players[gameState.currentPlayer];
      if (!currentPlayer) return;

      // Only field operatives can select cards
      if (currentPlayer.type === 'spy') {
        alert('Ø±Ø¦ÙŠØ³ Ø§Ù„Ø¬ÙˆØ§Ø³ÙŠØ³ Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª');
        return;
      }

      // Check if it's the player's team turn
      if (currentPlayer.team !== gameState.currentTurn) {
        alert('Ù„ÙŠØ³ Ø¯ÙˆØ± ÙØ±ÙŠÙ‚Ùƒ');
        return;
      }

      card.revealed = true;
      
      // Add highlight effect
      const cardElement = document.querySelectorAll('.card')[cardId];
      cardElement.classList.add('highlight');

      // Check card type and handle accordingly
      if (card.color === 'assassin') {
        gameState.winner = currentPlayer.team === 'red' ? 'blue' : 'red';
        addChatMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', `ğŸ’€ ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù‚Ø§ØªÙ„! ÙØ§Ø² Ø§Ù„ÙØ±ÙŠÙ‚ ${gameState.winner === 'red' ? 'Ø§Ù„Ø£Ø­Ù…Ø±' : 'Ø§Ù„Ø£Ø²Ø±Ù‚'}`);
        showWinner();
      } else if (card.color === currentPlayer.team) {
        // Correct team card
        if (currentPlayer.team === 'red') {
          gameState.redScore--;
        } else {
          gameState.blueScore--;
        }
        addChatMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', `âœ… ${currentPlayer.name} Ø§Ø®ØªØ§Ø± Ø¨Ø·Ø§Ù‚Ø© ØµØ­ÙŠØ­Ø©: ${card.word}`);
        
        // Check for win
        if (gameState.redScore === 0) {
          gameState.winner = 'red';
          showWinner();
        } else if (gameState.blueScore === 0) {
          gameState.winner = 'blue';
          showWinner();
        }
      } else {
        // Wrong team card or neutral
        addChatMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', `âŒ ${currentPlayer.name} Ø§Ø®ØªØ§Ø± Ø¨Ø·Ø§Ù‚Ø© Ø®Ø§Ø·Ø¦Ø©: ${card.word}`);
        switchTurn();
      }

      updateDisplay();
    }

    // Switch turn
    function switchTurn() {
      gameState.currentTurn = gameState.currentTurn === 'red' ? 'blue' : 'red';
    }

    // Pass turn
    function passTurn() {
      const currentPlayer = gameState.players[gameState.currentPlayer];
      if (!currentPlayer) return;

      if (currentPlayer.team !== gameState.currentTurn) {
        alert('Ù„ÙŠØ³ Ø¯ÙˆØ± ÙØ±ÙŠÙ‚Ùƒ');
        return;
      }

      switchTurn();
      addChatMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', `${currentPlayer.name} Ù…Ø±Ø± Ø§Ù„Ø¯ÙˆØ±`);
      updateDisplay();
    }

    // Toggle spymaster mode
    function toggleSpymaster() {
      const currentPlayer = gameState.players[gameState.currentPlayer];
      if (!currentPlayer) return;

      if (currentPlayer.type !== 'spy') {
        alert('ÙÙ‚Ø· Ø±Ø¦ÙŠØ³ Ø§Ù„Ø¬ÙˆØ§Ø³ÙŠØ³ ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„ÙˆØ¶Ø¹');
        return;
      }

      gameState.spymasterMode = !gameState.spymasterMode;
      const btn = document.getElementById('spymasterBtn');
      btn.textContent = gameState.spymasterMode ? 'Ø¥ÙŠÙ‚Ø§Ù ÙˆØ¶Ø¹ Ø±Ø¦ÙŠØ³ Ø§Ù„Ø¬ÙˆØ§Ø³ÙŠØ³' : 'ØªØ´ØºÙŠÙ„ ÙˆØ¶Ø¹ Ø±Ø¦ÙŠØ³ Ø§Ù„Ø¬ÙˆØ§Ø³ÙŠØ³';
      updateBoard();
    }

    // Check if current player is spymaster
    function isSpymaster() {
      const currentPlayer = gameState.players[gameState.currentPlayer];
      return currentPlayer && currentPlayer.type === 'spy';
    }

    // Update scores
    function updateScores() {
      document.getElementById('redScore').textContent = gameState.redScore;
      document.getElementById('blueScore').textContent = gameState.blueScore;
    }

    // Update turn indicator
    function updateTurnIndicator() {
      const indicator = document.getElementById('turnIndicator');
      indicator.textContent = `Ø¯ÙˆØ± Ø§Ù„ÙØ±ÙŠÙ‚ ${gameState.currentTurn === 'red' ? 'Ø§Ù„Ø£Ø­Ù…Ø±' : 'Ø§Ù„Ø£Ø²Ø±Ù‚'}`;
    }

    // Update players list
    function updatePlayersList() {
      const list = document.getElementById('playersList');
      list.innerHTML = '';

      Object.values(gameState.players).forEach(player => {
        const playerDiv = document.createElement('div');
        playerDiv.className = 'player-item';
        
        const nameSpan = document.createElement('span');
        nameSpan.textContent = player.name;
        
        const roleSpan = document.createElement('span');
        roleSpan.className = 'player-role';
        roleSpan.textContent = `${player.type === 'spy' ? 'Ø±Ø¦ÙŠØ³ Ø¬ÙˆØ§Ø³ÙŠØ³' : 'Ø¹Ù…ÙŠÙ„ Ù…ÙŠØ¯Ø§Ù†ÙŠ'} - ${player.team === 'red' ? 'Ø£Ø­Ù…Ø±' : 'Ø£Ø²Ø±Ù‚'}`;
        
        playerDiv.appendChild(nameSpan);
        playerDiv.appendChild(roleSpan);
        list.appendChild(playerDiv);
      });
    }

    // Show winner
    function showWinner() {
      const modal = document.getElementById('winnerModal');
      const winnerText = document.getElementById('winnerText');
      winnerText.textContent = `ğŸ‰ Ø§Ù„ÙØ±ÙŠÙ‚ ${gameState.winner === 'red' ? 'Ø§Ù„Ø£Ø­Ù…Ø±' : 'Ø§Ù„Ø£Ø²Ø±Ù‚'} ÙŠÙÙˆØ²!`;
      modal.classList.remove('hidden');
    }

    // Close winner modal
    function closeWinnerModal() {
      document.getElementById('winnerModal').classList.add('hidden');
    }

    // New game
    function newGame() {
      gameState.cards = [];
      gameState.currentTurn = 'red';
      gameState.redScore = 9;
      gameState.blueScore = 8;
      gameState.winner = null;
      gameState.spymasterMode = false;
      
      closeWinnerModal();
      generateCards();
      updateDisplay();
      addChatMessage('Ø§Ù„Ù†Ø¸Ø§Ù…', 'Ø¨Ø¯Ø£Øª Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©!');
    }

    // Chat functionality
    function sendMessage() {
      const input = document.getElementById('chatInput');
      const message = input.value.trim();
      
      if (message && gameState.currentPlayer) {
        addChatMessage(gameState.currentPlayer, message);
        input.value = '';
      }
    }

    function addChatMessage(sender, message) {
      const chatMessages = document.getElementById('chatMessages');
      const messageDiv = document.createElement('div');
      messageDiv.className = 'chat-message';
      
      const time = new Date().toLocaleTimeString('ar-SA', { 
        hour: '2-digit', 
        minute: '2-digit' 
      });
      
      messageDiv.innerHTML = `
        <span class="username">${sender}</span>
        <span class="time">${time}</span>
        <div>${message}</div>
      `;
      
      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Event listeners
    document.getElementById('chatInput').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        sendMessage();
      }
    });

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
    });
  </script>
</body>
</html>
